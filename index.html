<!DOCTYPE html>
<html>
<head>
  <title>Authorize with Google</title>
  <script>
    function authorize() {
      const clientId = '870470662608-g8ikslmnphqs9rogtpm66p0nbfskc0jr.apps.googleusercontent.com';
      const redirectUri = 'https://architechbfa.github.io/sheets-drag-and-drop/';
      const scope = 'https://www.googleapis.com/auth/drive.file';
      const authUrl =
        `https://accounts.google.com/o/oauth2/v2/auth?` +
        `response_type=token&client_id=${clientId}` +
        `&redirect_uri=${redirectUri}` +
        `&scope=${encodeURIComponent(scope)}` +
        `&prompt=consent`;

      window.location.href = authUrl;
    }

    // Save access token on redirect
    window.onload = () => {
      if (window.location.hash.includes('access_token')) {
        const params = new URLSearchParams(window.location.hash.slice(1));
        const token = params.get('access_token');
        if (token) {
          localStorage.setItem('google_access_token', token);
          document.body.innerHTML = '<h2>âœ… Authorized! You can close this tab.</h2>';
        }
      }
    };
  </script>
</head>
<body>
  <h1>Authorize with Google</h1>
  <button onclick="authorize()">Click to Authorize</button>
</body>
</html>
