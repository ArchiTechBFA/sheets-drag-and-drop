<!DOCTYPE html>
<html>
<head>
  <title>Sheets Drag & Drop Auth</title>
  <meta charset="utf-8">
</head>
<body style="font-family: sans-serif; padding: 2rem; text-align: center;">
  <h1>ðŸ§¾ Sheets Drag & Drop Authorization</h1>
  <p>Click below to authorize with Google Drive.</p>
  <button id="authBtn" style="font-size: 1rem; padding: 0.5rem 1rem;">Authorize with Google</button>

  <script>
    const hash = window.location.hash;
    if (hash.includes("access_token")) {
      const token = new URLSearchParams(hash.substring(1)).get("access_token");
      localStorage.setItem("google_access_token", token);
      document.body.innerHTML = "<h2>âœ… Authorized! You may now close this tab and drag files into Google Sheets.</h2>";
    }

    document.getElementById("authBtn")?.addEventListener("click", () => {
      const clientId = "870470662608-g8ikslmnphqs9rogtpm66p0nbfskc0jr.apps.googleusercontent.com";
      const redirectUri = "https://architechbfa.github.io/sheets-drag-and-drop/";
      const scope = "https://www.googleapis.com/auth/drive.file";
      const authUrl =
        `https://accounts.google.com/o/oauth2/v2/auth` +
        `?response_type=token&client_id=${clientId}` +
        `&redirect_uri=${redirectUri}&scope=${scope}&prompt=consent`;

      window.location.href = authUrl;
    });
  </script>
</body>
</html>
